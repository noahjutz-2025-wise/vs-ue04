# Direct Messages Server

## Quickstart

Start the Server with

```sh
javac *.java && java Server
```

Send a message with

```sh
echo -n "00 00 04 046e6f6168" | xxd -r -p | nc localhost 1225 | xxd
```

## Protocol

- TYPE
  - 0 ReqRegister
  - 1 ReqSend
  - 2 ReqGet
  - 3 ResStatus
  - 4 ResGet
- REQID: Generated by client
- LENGTH: 0-255
- LENGTH LENGTH: 0-65535

### Request

Register request

```
+--------+--------+--------+--------+
|TYPE    |REQID   |LENGTH  |USER...
+--------+--------+--------+--------+
 ...     |
+--------+
```

- Example:
    - 0 0 4 noah
    - 00 00 04 6e6f6168

Send request

```
+--------+--------+--------+--------+
|TYPE    |REQID   |LENGTH  |USER...
+--------+--------+--------+--------+
 ...     |LENGTH  |RECIP...         |
+--------+--------+--------+--------+
|LENGTH   LENGTH  |MSG...           |
+--------+--------+--------+--------+
```

- Example:
    - 1 0 4 noah 5 sarah 12 salutations!
    - 01 00 04 6e6f6168 05 7361726168 000C 73616c75746174696f6e7321

Get request

```
+--------+--------+--------+--------+
|TYPE    |REQID   |LENGTH  |USER...
+--------+--------+--------+--------+
 ...     |
+--------+
```

- Example:
    - 2 0 5 sarah
    - 02 00 05 7361726168

### Response

- STATUS
  - 0 OK
  - 1 Request malformed
  - 2 Internal error

Status response

```
+--------+--------+--------+--------+
|TYPE    |REQID   |STATUS  |LENGTH  |
+--------+--------+--------+--------+
|MESSAGE...                         |
+--------+--------+--------+--------+
```

Get response

```
+--------+--------+--------+--------+
|TYPE    |REQID   |STATUS  |AMOUNT
+--------+--------+--------+--------+
 AMOUNT  |LENGTH  |SENDER...        |
+--------+--------+--------+--------+
|LENGTH  |RECIP...         |LENGTH
+--------+--------+--------+--------+
 LENGTH  |MSG...           |
+--------+--------+--------+
```
